<html>
  
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../style.css">
    <base target="_parent">
    <title data-trilium-title>En Bankrøvers Bekendelser</title>
  </head>
  
  <body>
    <div class="content">
       <h1 data-trilium-h1>En Bankrøvers Bekendelser</h1>

      <div class="ck-content">
        <p><i>Vi har holdt lidt øje med en bandit vi mistænker for at planlægge et røveri - vi ved bare ikke hvor. Vi fik heldigvis en kendelse til at anholde ham, og ransage hans hjem. Desværre kan vi ikke finde noget, og vi må lade ham gå igen medmindre du kan hjælpe. Der var intet på hans computer, men han havde en virtuel maskine der var krypteret... Det eneste vi fandt var en virtuel hukommelsesfil, et billede af en lasagne og et notat: "slet huskeliste"- er det noget du kan bruge?</i>
        </p>
        <p><i>forensics_en-bankrovers-bekendelser_lasagne.zip forensics_en-bankrovers-memory.rar</i>
        </p>
        <p>&nbsp;</p>
        <p>Denne har jeg kun løst 90%. Jeg manglede steghide delen, som jeg senere
          fandt ud af, og inkluderer derfor den fulde løsning.&nbsp;</p>
        <p>Som det i beskrivelsen benævnes så er der givet en memory dump fil af
          en virtuel maskine i form af mem.vmem, samt et billede af en lasagne.&nbsp;</p>
        <p>Grundet kommentaren om huskelisten kiggede jeg på de processor der kørte
          på maskinen med Volatility 3:&nbsp;</p><pre><code class="language-text-x-sh">5472    5424    winlogon.exe    0xe001c3cf0840  2       -       2       False   2024-02-25 15:32:33.000000      N/A    Disabled

2576    5472    dwm.exe 0xe001c35b0080  9       -       2       False   2024-02-25 15:32:33.000000      N/A     Disabled

5456    1744    vm3dservice.ex  0xe001c422d840  4       -       2       False   2024-02-25 15:32:33.000000      N/A    Disabled

3916    808     sihost.exe      0xe001c3549840  16      -       2       False   2024-02-25 15:32:39.000000      N/A    Disabled

4028    808     taskhostw.exe   0xe001c40d8840  10      -       2       False   2024-02-25 15:32:39.000000      N/A    Disabled

5112    5472    userinit.exe    0xe001c4185080  0       -       2       False   2024-02-25 15:32:39.000000      2024-02-25 15:33:02.000000      Disabled

5364    5112    explorer.exe    0xe001c4049080  72      -       2       False   2024-02-25 15:32:39.000000      N/A    Disabled

5420    620     RuntimeBroker.  0xe001c29cc080  19      -       2       False   2024-02-25 15:32:39.000000      N/A    Disabled

5320    620     ShellExperienc  0xe001c3736080  39      -       2       False   2024-02-25 15:32:39.000000      N/A    Disabled

4184    620     ApplicationFra  0xe001c415e080  16      -       2       False   2024-02-25 15:32:42.000000      N/A    Disabled

5528    524     svchost.exe     0xe001c3a13840  3       -       2       False   2024-02-25 15:32:49.000000      N/A    Disabled

1596    5364    vmtoolsd.exe    0xe001c3dbb080  8       -       2       False   2024-02-25 15:32:50.000000      N/A    Disabled

1104    176     OneDrive.exe    0xe001c44bc840  0       -       2       False   2024-02-25 15:33:18.000000      2024-02-25 15:34:04.000000      Disabled

1184    6036    thunderbird.ex  0xe001c2996840  0       -       2       False   2024-02-25 15:36:32.000000      2024-02-25 15:40:54.000000      Disabled

2832    5364    notepad.exe     0xe001c3042080  4       -       2       False   2024-02-25 15:40:55.000000      N/A    Disabled

4244    620     InstallAgent.e  0xe001c53dd840  3       -       2       False   2024-02-25 15:50:47.000000      N/A    Disabled

5972    620     SearchUI.exe    0xe001c3f82680  44      -       2       False   2024-02-25 15:55:38.000000      N/A    Disabled

1604    524     svchost.exe     0xe001c3977080  3       -       0       False   2024-02-25 15:56:52.000000      N/A    Disabled

5924    524     sedsvc.exe      0xe001c19f8840  7       -       0       False   2024-02-25 15:56:57.000000      N/A    Disabled

3312    808     taskhostw.exe   0xe001c3571080  3       -       2       False   2024-02-25 16:02:52.000000      N/A    Disabled

2912    524     svchost.exe     0xe001c4e8d540  5       -       0       False   2024-02-25 16:42:26.000000      N/A    Disabled

5808    5364    cmd.exe 0xe001c161d840  7       -       2       False   2024-02-25 16:44:09.000000      N/A     Disabled

1432    5808    conhost.exe     0xe001c29c4080  2       -       2       False   2024-02-25 16:44:09.000000      N/A    Disabled

488     524     svchost.exe     0xe001c3b3e080  5       -       0       False   2024-02-25 16:44:17.000000      N/A    Disabled

452     620     Microsoft.Phot  0xe001c40d6080  36      -       2       False   2024-02-25 16:44:18.000000      N/A    Disabled

3268    620     dllhost.exe     0xe001c3922840  10      -       2       False   2024-02-25 16:44:27.000000      N/A    Disabled

3204    3436    SearchProtocol  0xe001c4fca080  8       -       0       False   2024-02-25 16:44:35.000000      N/A    Disabled

4928    3436    SearchFilterHo  0xe001c51da080  6       -       0       False   2024-02-25 16:44:35.000000      N/A    Disabled

5088    1824    cmd.exe 0xe001c1048080  0       -       0       False   2024-02-25 16:44:46.000000      2024-02-25 16:44:46.000000 
</code></pre>
        <p>Her er et snippet af den fulde procesliste. Den mest spændende er PID
          2832, notepad.exe. Det er nok der der er størst chance for at finde en
          huskeliste der skulle slettes. Vi kan dertil filedump PID 2832, og finde
          ud af det.&nbsp;</p><pre><code class="language-text-plain">python3 vol.py -f mem.vmem windows.memmap --dump --pid 2832</code></pre>
        <p>Vi åbner vores dump fil i en hexeditor som HxD:&nbsp;</p>
        <figure class="table"
        style="width:100%;">
          <table class="ck-table-resized">
            <colgroup>
              <col style="width:36.77%;">
                <col style="width:63.23%;">
            </colgroup>
            <tbody>
              <tr>
                <td>48 75 73 6B 65 6C 69 73 74 65 3A 0D 0A 0D 0A 52</td>
                <td>Huskeliste: &nbsp;R</td>
              </tr>
              <tr>
                <td>6F 62 20 62 61 6E 6B 0D 0A 44 6F 6E 74 20 67 65</td>
                <td>ob bank Dont ge</td>
              </tr>
              <tr>
                <td>74 20 73 68 6F 74 0D 0A 4D 69 6E 4C 69 76 72 65</td>
                <td>t shot MinLivre</td>
              </tr>
              <tr>
                <td>74 45 72 4C 61 73 61 67 6E 65 30 36 0D 0A 0D 0A</td>
                <td>tErLasagne06</td>
              </tr>
              <tr>
                <td>3A 29 20 48 65 68 65 20 3A 29</td>
                <td>:) Hehe :)</td>
              </tr>
            </tbody>
          </table>
        </figure>
        <p>Som er lidt ulæseligt, men oversættes selvfølgelig til:
          <br>Huskeliste:&nbsp;
          <br>*Rob Bank
          <br>*Dont get shot</p>
        <p>*<strong>MinLivretErLasagne06</strong> :)</p>
        <p>*Hehe :)&nbsp;</p>
        <p>Her kommer delen som jeg ikke selv indså indenfor tidsrammen:&nbsp;</p>
        <p>Vores jpg fil må indeholde noget vi skal bruge kodeordet til. Der må derfor
          forelægge en steganografisk manipulation. Vi kan prøve at bruge “steghide”
          til at få sådanne informationer:&nbsp;</p><pre><code class="language-text-x-sh">──(kali㉿kali)-[~/Desktop]

└─$ steghide --info lasagne.jpg 

"lasagne.jpg":

  format: jpeg

  capacity: 3.4 KB

Try to get information about embedded data ? (y/n) y

Enter passphrase: 

  embedded file "Planer.rar":

    size: 382.0 Byte

    encrypted: rijndael-128, cbc

    compressed: yes
  </code></pre>
        <p>Der er altså gemt et arkiv i “rar” filformat. Vi kan derfor bruge kodeordet
          fra huskelisten til at ekstrahere arkivet fra filen:&nbsp;</p><pre><code class="language-text-x-sh">┌──(kali㉿kali)-[~/Desktop]

└─$ steghide --extract -sf lasagne.jpg

Enter passphrase: 

the file "Planer.rar" does already exist. overwrite ? (y/n) y

wrote extracted data to "Planer.rar".</code></pre>
        <p>Hvis vi dernæst åbner Planer.RAR med samme kodeord, og åbner filen "PlanSnedig.txt
          indeni så får vi følgende besked:&nbsp;</p>
        <p>Det Bliver Danske Bank!&nbsp;
          <br>og dernæst flaget: <strong>DDC{1_W15H_1_Wa5_a_UN1c0Rn}</strong>
        </p>
      </div>
    </div>
  </body>

</html>